<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap');

  :root {
    /* Palette Or Sophistiqu√©e */
    --gold-primary: #C5A021;
    --gold-dark: #926F12;
    --gold-light: #E8D081;
    --gold-soft: rgba(197, 160, 33, 0.1);
    
    /* Couleurs de contraste */
    --dark-navy: #0F172A;
    --slate-text: #475569;
    --bg-gradient: linear-gradient(180deg, #FFFFFF 0%, #F8FAFC 100%);
    --white: #ffffff;
    
    /* Design tokens */
    --shadow-premium: 0 25px 50px -12px rgba(146, 111, 18, 0.15);
    --radius-lg: 24px;
    --transition-smooth: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .candidates-wrap {
    background: var(--bg-gradient);
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: var(--dark-navy);
    padding: 60px 20px;
    min-height: 100vh;
  }

  .candidates-inner {
    max-width: 1200px;
    margin: 0 auto;
  }

  /* --- HEADER & HERO --- */
  .cand-hero {
    text-align: center;
    margin-bottom: 60px;
  }

  .cand-hero h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(2.5rem, 5vw, 4rem);
    font-weight: 800;
    margin-bottom: 16px;
    background: linear-gradient(to right, var(--gold-dark), var(--gold-primary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .cand-hero p {
    color: var(--slate-text);
    font-size: 1.1rem;
    max-width: 600px;
    margin: 0 auto 40px;
  }

  /* --- FORMULAIRE DE RECHERCHE --- */
  .search-container {
    background: var(--white);
    padding: 10px;
    border-radius: 100px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    max-width: 800px;
    margin: 0 auto;
    border: 1px solid rgba(197, 160, 33, 0.15);
  }

  .search-group {
    display: flex;
    align-items: center;
    flex: 1;
    min-width: 200px;
    padding: 0 15px;
  }

  .search-input, .search-select {
    border: none;
    width: 100%;
    padding: 12px;
    font-size: 15px;
    font-family: inherit;
    color: var(--dark-navy);
  }

  .search-input:focus, .search-select:focus { outline: none; }

  .search-divider {
    width: 1px;
    height: 30px;
    background: #E2E8F0;
    align-self: center;
  }

  .search-btn {
    background: var(--gold-dark);
    color: white;
    border: none;
    padding: 14px 32px;
    border-radius: 100px;
    font-weight: 700;
    cursor: pointer;
    transition: var(--transition-smooth);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 14px;
  }

  .search-btn:hover {
    background: var(--dark-navy);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }

  /* --- GRID & CARDS --- */
  .candidates-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 40px;
    margin-top: 50px;
  }

  .candidate-card {
    background: var(--white);
    border-radius: var(--radius-lg);
    overflow: hidden;
    transition: var(--transition-smooth);
    border: 1px solid rgba(0,0,0,0.03);
    position: relative;
    display: flex;
    flex-direction: column;
  }

  .candidate-card:hover {
    transform: translateY(-12px);
    box-shadow: var(--shadow-premium);
    border-color: var(--gold-soft);
  }

  .candidate-media {
    position: relative;
    height: 340px;
    overflow: hidden;
  }

  .candidate-media img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.8s ease;
  }

  .candidate-card:hover .candidate-media img {
    transform: scale(1.1);
  }

  .candidate-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to top, rgba(15, 23, 42, 0.8) 0%, transparent 60%);
    opacity: 0;
    transition: 0.4s;
  }

  .candidate-card:hover .candidate-overlay { opacity: 1; }

  .candidate-category-pill {
    position: absolute;
    top: 20px;
    right: 20px;
    background: var(--white);
    color: var(--gold-dark);
    padding: 6px 16px;
    border-radius: 50px;
    font-size: 12px;
    font-weight: 800;
    text-transform: uppercase;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  }

  /* Ecole pill displayed over the image (bottom-left) */
  .candidate-ecole-pill {
    position: absolute;
    left: 16px;
    bottom: 16px;
    background: linear-gradient(90deg, rgba(0,0,0,0.6), rgba(0,0,0,0.35));
    color: white;
    padding: 8px 12px;
    border-radius: 12px;
    font-size: 13px;
    font-weight: 700;
    z-index: 4;
    box-shadow: 0 6px 18px rgba(0,0,0,0.25);
  }

  .candidate-meta {
    display: flex;
    gap: 10px;
    justify-content: center;
    align-items: center;
    margin-bottom: 12px;
  }

  .meta-pill {
    background: rgba(237, 242, 247, 0.8);
    color: var(--dark-navy);
    padding: 6px 10px;
    border-radius: 999px;
    font-size: 13px;
    font-weight: 600;
  }

  .meta-votes {
    background: linear-gradient(90deg, var(--gold-light), var(--gold-primary));
    color: var(--dark-navy);
    box-shadow: 0 6px 18px rgba(197,160,33,0.12);
  }

  .candidate-body {
    padding: 30px;
    text-align: center;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }

  .candidate-name {
    font-family: 'Playfair Display', serif;
    font-size: 24px;
    margin-bottom: 10px;
    color: var(--dark-navy);
  }

  .candidate-desc {
    color: var(--slate-text);
    font-size: 15px;
    line-height: 1.6;
    margin-bottom: 25px;
    flex-grow: 1;
  }

  /* --- BUTTONS --- */
  .candidate-actions {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  .btn-premium {
    padding: 12px 20px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 14px;
    text-decoration: none;
    transition: var(--transition-smooth);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .btn-view {
    background: var(--gold-soft);
    color: var(--gold-dark);
  }

  .btn-view:hover {
    background: var(--gold-primary);
    color: white;
  }

  .btn-vote {
    background: var(--dark-navy);
    color: white;
    box-shadow: 0 4px 12px rgba(15, 23, 42, 0.2);
  }

  .btn-vote:hover {
    background: var(--gold-dark);
    transform: scale(1.05);
  }

  /* Mobile */
  @media (max-width: 640px) {
    .search-container { border-radius: 20px; }
    .search-divider { display: none; }
    .search-btn { width: 100%; }
    .candidate-actions { grid-template-columns: 1fr; }
  }
</style>

<div class="candidates-wrap">
  <div class="candidates-inner">
    
    <header class="cand-hero">
      <h1>Nos Leaders de Demain</h1>
      <p>D√©couvrez les candidats d'exception qui s'engagent pour l'innovation et l'excellence au sein de nos √©coles.</p>
      
      <%= form_with url: candidates_path, method: :get, local: true, class: "search-container" do |f| %>
        <div class="search-group">
          <span style="margin-right: 10px">üîç</span>
          <%= f.text_field :query, value: params[:query], placeholder: "Nom...", class: "search-input" %>
        </div>
        <div class="search-divider"></div>
        <div class="search-group">
          <%= f.select :ecole_id, options_from_collection_for_select(@ecoles, :id, :nom, params[:ecole_id]), { include_blank: 'Toutes les √©coles' }, class: 'search-select' %>
        </div>
        <%= f.submit "Rechercher", class: "search-btn" %>
      <% end %>
    </header>

    <div style="margin-bottom: 20px; color: var(--gold-dark); font-weight: 600;">
      ‚ú® <%= @total_candidates || @candidates.count %> candidats inspirants trouv√©s
    </div>

    <% if @candidates.any? %>
      <div class="candidates-grid">
        <% @candidates.each do |candidate| %>
          <article class="candidate-card">
            <div class="candidate-media">
              <% if candidate.image.attached? %>
                <%= image_tag url_for(candidate.image), alt: candidate.name %>
              <% else %>
                <%= image_tag 'sarki.webp', alt: candidate.name %>
              <% end %>
              <div class="candidate-overlay"></div>
              <% if candidate.respond_to?(:ecole) && candidate.ecole.present? %>
                <span class="candidate-ecole-pill"><%= candidate.ecole.nom %></span>
              <% end %>
              <% if candidate.respond_to?(:category) && candidate.category.present? %>
                <span class="candidate-category-pill"><%= candidate.category %></span>
              <% end %>
            </div>

            <div class="candidate-body">
              <h3 class="candidate-name"><%= candidate.name %></h3>
              <div class="candidate-meta" aria-hidden="false">
                <% if candidate.respond_to?(:ecole) && candidate.ecole.present? %>
                  <span class="meta-pill meta-school" title="√âcole"><%= candidate.ecole.nom %></span>
                <% end %>
                <span class="meta-pill meta-votes" title="Votes">üèÜ <strong><%= candidate.total_votes %></strong></span>
              </div>
              <p class="candidate-desc">
                <%= truncate(candidate.try(:description) || candidate.try(:bio) || 'Profil en cours de finalisation...', length: 100) %>
              </p>

              <div class="candidate-actions">
                <% show_path = defined?(candidate_path) ? candidate_path(candidate) : "/candidates/#{candidate.id}" %>
                <%= link_to show_path, class: 'btn-premium btn-view' do %>
                  <span>D√©tails</span>
                <% end %>
                
                <%= button_tag type: 'button', class: 'btn-premium btn-vote vote-btn', data: { candidate: candidate.name, candidate_id: candidate.id } do %>
                  <span>Voter</span>
                <% end %>
              </div>
            </div>
          </article>
        <% end %>
      </div>

      <!-- Pagination -->
      <% if defined?(@total_pages) && @total_pages > 1 %>
        <nav class="pagination" aria-label="Pagination" style="display:flex; justify-content:center; margin-top: 32px;">
          <div style="display:flex; gap:8px; align-items:center;">
            <% prev_disabled = @page <= 1 %>
            <% next_disabled = @page >= @total_pages %>

            <% base_params = {}.merge(params.permit(:query, :ecole_id).to_h) %>

            <%= link_to '‚Üê Pr√©c', candidates_path(base_params.merge(page: @page - 1)), class: "btn-premium", style: (prev_disabled ? 'opacity:0.5; pointer-events:none;' : '') %>

            <%# show a few page links around current page %>
            <% left = [1, @page - 2].max %>
            <% right = [@total_pages, @page + 2].min %>
            <% (left..right).each do |pnum| %>
              <% if pnum == @page %>
                <span style="padding:8px 12px; background:var(--gold-primary); color:#fff; border-radius:8px; font-weight:700;"><%= pnum %></span>
              <% else %>
                <%= link_to pnum, candidates_path(base_params.merge(page: pnum)), style: 'padding:8px 12px; border-radius:8px; text-decoration:none; color:var(--dark-navy); background:#fff; border:1px solid #eee;' %>
              <% end %>
            <% end %>

            <%= link_to 'Suiv ‚Üí', candidates_path(base_params.merge(page: @page + 1)), class: "btn-premium", style: (next_disabled ? 'opacity:0.5; pointer-events:none;' : '') %>
          </div>
        </nav>
      <% end %>
    <% else %>
      <div style="text-align: center; padding: 100px 0; background: white; border-radius: 30px; border: 2px dashed #e2e8f0;">
        <div style="font-size: 50px; margin-bottom: 20px;">üë§</div>
        <h3 style="font-family: 'Playfair Display'; font-size: 24px;">Aucun candidat trouv√©</h3>
        <p style="color: var(--slate-text);">Modifiez vos crit√®res de recherche pour d√©couvrir d'autres profils.</p>
        <%= link_to 'R√©initialiser', candidates_path, style: "color: var(--gold-dark); font-weight: bold; text-decoration: none; margin-top: 20px; display: inline-block;" %>
      </div>
    <% end %>

  </div>
</div>

<%= render 'shared/vote_modal' %>