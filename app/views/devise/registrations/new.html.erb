<div class="signup-wrapper">
  <div class="signup-container">

    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <div class="signup-card">
      <div class="card-glow"></div>
      <div class="card-shimmer"></div>

      <!-- Header -->
      <div class="card-header">
        <div class="icon-badge">
          <div class="badge-ring"></div>
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M16 21V19C16 17.9391 15.5786 16.9217 14.8284 16.1716C14.0783 15.4214 13.0609 15 12 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="8.5" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M20 8V14M17 11H23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h2>Créer un compte</h2>
        <p>Rejoignez votre espace personnel</p>
      </div>

      <!-- Form -->
      <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: 'signup-form' }) do |f| %>

        <%= render "devise/shared/error_messages", resource: resource %>

        <div class="form-section">

          <!-- Steps indicator -->
          <div class="steps-indicator">
            <div class="step active">
              <div class="step-dot"></div>
              <span>Identité</span>
            </div>
            <div class="step-line"></div>
            <div class="step">
              <div class="step-dot"></div>
              <span>Sécurité</span>
            </div>
          </div>

          <!-- Email -->
          <div class="field">
            <%= f.label :email, class: 'form-label' %>
            <div class="input-wrapper">
              <span class="input-icon">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M22 6L12 13L2 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </span>
              <%= f.email_field :email,
                  autofocus: true,
                  autocomplete: "email",
                  class: 'form-input',
                  placeholder: 'nom@exemple.com' %>
              <span class="input-border"></span>
              <span class="input-valid-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </span>
            </div>
          </div>

          <!-- Divider -->
          <div class="section-divider">
            <span></span>
            <p>Sécurité</p>
            <span></span>
          </div>

          <!-- Password -->
          <div class="field">
            <%= f.label :password, class: 'form-label' %>
            <div class="input-wrapper">
              <span class="input-icon">
                <svg viewBox="0 0 24 24" fill="none">
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M7 11V7C7 5.67 7.53 4.4 8.46 3.46C9.4 2.53 10.67 2 12 2C13.33 2 14.6 2.53 15.54 3.46C16.47 4.4 17 5.67 17 7V11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </span>
              <%= f.password_field :password,
                  autocomplete: "new-password",
                  class: 'form-input',
                  id: 'password-field',
                  placeholder: '••••••••' %>
              <span class="input-border"></span>
              <button type="button" class="toggle-password" data-target="password-field">
                <svg class="eye-open" viewBox="0 0 24 24" fill="none">
                  <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <svg class="eye-closed" viewBox="0 0 24 24" fill="none" style="display:none">
                  <path d="M17.94 17.94C16.23 19.24 14.15 19.96 12 20C5 20 1 12 1 12C2.24 9.68 3.97 7.66 6.06 6.06M9.9 4.24C10.59 4.08 11.29 4 12 4C19 4 23 12 23 12C22.39 13.14 21.67 14.2 20.84 15.19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <line x1="1" y1="1" x2="23" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>

            <!-- Password strength meter -->
            <div class="strength-meter" id="strength-meter">
              <div class="strength-bars">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
              </div>
              <span class="strength-label" id="strength-label">—</span>
            </div>

            <% if @minimum_password_length %>
              <p class="field-hint">
                <svg viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><path d="M12 16V12M12 8H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                Minimum <%= @minimum_password_length %> caractères
              </p>
            <% end %>
          </div>

          <!-- Password confirmation -->
          <div class="field">
            <%= f.label :password_confirmation, "Confirmer le mot de passe", class: 'form-label' %>
            <div class="input-wrapper">
              <span class="input-icon">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M12 22C12 22 20 18 20 12V5L12 2L4 5V12C4 18 12 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </span>
              <%= f.password_field :password_confirmation,
                  autocomplete: "new-password",
                  class: 'form-input',
                  id: 'password-confirm-field',
                  placeholder: '••••••••' %>
              <span class="input-border"></span>
              <button type="button" class="toggle-password" data-target="password-confirm-field">
                <svg class="eye-open" viewBox="0 0 24 24" fill="none">
                  <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <svg class="eye-closed" viewBox="0 0 24 24" fill="none" style="display:none">
                  <path d="M17.94 17.94C16.23 19.24 14.15 19.96 12 20C5 20 1 12 1 12C2.24 9.68 3.97 7.66 6.06 6.06M9.9 4.24C10.59 4.08 11.29 4 12 4C19 4 23 12 23 12C22.39 13.14 21.67 14.2 20.84 15.19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <line x1="1" y1="1" x2="23" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <span class="match-indicator" id="match-indicator"></span>
            </div>
          </div>

          <!-- Terms -->
          <div class="terms-row">
            <input type="checkbox" id="terms" class="custom-checkbox" required>
            <label for="terms" class="checkbox-label">
              J'accepte les <a href="#" class="terms-link">conditions d'utilisation</a> et la <a href="#" class="terms-link">politique de confidentialité</a>
            </label>
          </div>

          <!-- Submit -->
          <div class="actions">
            <%= f.submit "Créer mon compte", class: 'submit-button' %>
          </div>
        </div>
      <% end %>

      <div class="card-footer">
        <%= render "devise/shared/links" %>
      </div>
    </div>

    <div class="security-note">
      <svg viewBox="0 0 24 24" fill="none">
        <path d="M12 22C12 22 20 18 20 12V5L12 2L4 5V12C4 18 12 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span>Connexion sécurisée SSL/TLS 256-bit</span>
    </div>

  </div>
</div>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=DM+Sans:wght@300;400;500;600&display=swap');

  :root {
    --gold-deep:   #8B6914;
    --gold-rich:   #B8860B;
    --gold-true:   #D4A017;
    --gold-bright: #E8B923;
    --gold-light:  #F5D060;
    --gold-pale:   #FDF0C0;

    --brown-dark:  #2C1810;
    --brown-deep:  #3D2314;
    --brown-mid:   #6B3D1E;
    --brown-warm:  #8B5E3C;

    --cream-pure:  #FFFDF5;
    --cream-warm:  #FDF6E3;
    --cream-tinted:#FAF0D0;

    --text-dark:   #1E1208;
    --text-mid:    #4A3020;
    --text-muted:  #7D5A40;
    --text-light:  #A0826A;

    --shadow-gold: rgba(184, 134, 11, 0.3);
    --shadow-deep: rgba(44, 24, 16, 0.5);

    --strength-weak:   #E05C5C;
    --strength-fair:   #E0A040;
    --strength-good:   #D4A017;
    --strength-strong: #4CAF6E;
  }

  .signup-wrapper * { margin:0; padding:0; box-sizing:border-box; }

  .signup-wrapper {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    background:
      radial-gradient(ellipse 80% 60% at 50% -10%, rgba(184,134,11,0.18) 0%, transparent 60%),
      radial-gradient(ellipse 60% 40% at 80% 90%, rgba(107,61,30,0.25) 0%, transparent 50%),
      linear-gradient(160deg, #1A0F08 0%, #261608 35%, #1E1208 65%, #120B05 100%);
    position: relative;
    overflow: hidden;
    font-family: 'DM Sans', sans-serif;
  }

  .signup-wrapper::before {
    content: '';
    position: fixed; inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none; opacity: 0.6; z-index: 0;
  }

  .signup-wrapper::after {
    content: '';
    position: fixed; inset: 0;
    background-image:
      linear-gradient(rgba(184,134,11,0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(184,134,11,0.04) 1px, transparent 1px);
    background-size: 48px 48px;
    pointer-events: none; z-index: 0;
  }

  /* Orbs */
  .orb { position:absolute; border-radius:50%; filter:blur(60px); pointer-events:none; z-index:0; }
  .orb-1 { width:400px; height:400px; top:-100px; left:-100px; background:radial-gradient(circle, rgba(184,134,11,0.15) 0%, transparent 70%); animation:orbFloat1 12s ease-in-out infinite; }
  .orb-2 { width:300px; height:300px; bottom:-80px; right:-80px; background:radial-gradient(circle, rgba(107,61,30,0.2) 0%, transparent 70%); animation:orbFloat2 16s ease-in-out infinite; }
  .orb-3 { width:200px; height:200px; top:40%; right:10%; background:radial-gradient(circle, rgba(232,185,35,0.08) 0%, transparent 70%); animation:orbFloat3 10s ease-in-out infinite; }
  @keyframes orbFloat1 { 0%,100%{ transform:translate(0,0) scale(1); } 50%{ transform:translate(30px,20px) scale(1.1); } }
  @keyframes orbFloat2 { 0%,100%{ transform:translate(0,0); } 50%{ transform:translate(-20px,-30px); } }
  @keyframes orbFloat3 { 0%,100%{ transform:translate(0,0) scale(1); opacity:1; } 50%{ transform:translate(15px,-10px) scale(1.2); opacity:0.7; } }

  /* Container */
  .signup-container {
    position: relative; z-index: 1;
    max-width: 480px; width: 100%;
    animation: slideIn 0.7s cubic-bezier(0.16, 1, 0.3, 1);
  }
  @keyframes slideIn {
    from { opacity:0; transform:translateY(40px) scale(0.95); }
    to   { opacity:1; transform:translateY(0) scale(1); }
  }

  /* Card */
  .signup-card {
    background: linear-gradient(155deg, var(--cream-pure) 0%, var(--cream-warm) 60%, var(--cream-tinted) 100%);
    border-radius: 20px;
    position: relative; overflow: hidden;
    box-shadow:
      0 40px 80px -20px var(--shadow-deep),
      0 0 0 1px rgba(184,134,11,0.25),
      0 0 0 4px rgba(184,134,11,0.06),
      inset 0 1px 0 rgba(255,255,255,0.8);
  }

  .card-glow {
    position: absolute; top:0; left:0; right:0; height:3px;
    background: linear-gradient(90deg, var(--gold-deep) 0%, var(--gold-bright) 35%, var(--gold-light) 50%, var(--gold-bright) 65%, var(--gold-deep) 100%);
    background-size: 200% 100%;
    animation: shimmer 3s ease-in-out infinite;
  }
  .card-shimmer {
    position: absolute; top:-50%; left:-60%; width:120%; height:200%;
    background: linear-gradient(105deg, transparent 40%, rgba(255,240,160,0.06) 50%, transparent 60%);
    animation: cardGleam 6s ease-in-out infinite; pointer-events:none;
  }
  @keyframes shimmer { 0%,100%{ background-position:0% 0%; } 50%{ background-position:100% 0%; } }
  @keyframes cardGleam { 0%,100%{ transform:translateX(-30%); } 50%{ transform:translateX(30%); } }

  /* Header */
  .card-header {
    text-align:center; padding:2.75rem 2.5rem 1.75rem;
    background:linear-gradient(180deg, rgba(184,134,11,0.07) 0%, transparent 100%);
    border-bottom:1px solid rgba(184,134,11,0.12); position:relative;
  }
  .card-header::before, .card-header::after {
    content:''; position:absolute; width:40px; height:40px;
    border-color:rgba(184,134,11,0.3); border-style:solid;
  }
  .card-header::before { top:16px; left:16px; border-width:2px 0 0 2px; border-radius:4px 0 0 0; }
  .card-header::after  { top:16px; right:16px; border-width:2px 2px 0 0; border-radius:0 4px 0 0; }

  .icon-badge {
    width:72px; height:72px; margin:0 auto 1.25rem;
    background:linear-gradient(135deg, var(--gold-deep) 0%, var(--gold-rich) 40%, var(--gold-bright) 100%);
    border-radius:50%; display:flex; align-items:center; justify-content:center;
    position:relative;
    box-shadow: 0 8px 32px var(--shadow-gold), 0 2px 8px rgba(0,0,0,0.2), inset 0 2px 6px rgba(255,255,255,0.25);
    animation:levitate 4s ease-in-out infinite;
  }
  .badge-ring {
    position:absolute; inset:-6px; border-radius:50%;
    border:2px solid transparent;
    background:linear-gradient(135deg, var(--gold-bright), var(--gold-deep), var(--gold-light)) border-box;
    -webkit-mask:linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite:destination-out; mask-composite:exclude;
    animation:ringPulse 3s ease-in-out infinite;
  }
  @keyframes ringPulse { 0%,100%{ opacity:0.4; transform:scale(1); } 50%{ opacity:1; transform:scale(1.05); } }
  @keyframes levitate { 0%,100%{ transform:translateY(0); } 50%{ transform:translateY(-6px); } }

  .icon-badge svg { width:30px; height:30px; color:#FFF8E0; z-index:1; position:relative; filter:drop-shadow(0 2px 4px rgba(0,0,0,0.25)); }

  .card-header h2 {
    font-family:'Playfair Display', serif; font-size:1.9rem; font-weight:700;
    color:var(--text-dark); margin-bottom:0.35rem; letter-spacing:-0.01em;
  }
  .card-header p { font-size:0.875rem; color:var(--text-muted); font-weight:400; letter-spacing:0.02em; }

  /* Steps */
  .steps-indicator {
    display:flex; align-items:center; justify-content:center;
    gap:0; margin-bottom:1.75rem;
  }
  .step { display:flex; flex-direction:column; align-items:center; gap:0.3rem; }
  .step-dot {
    width:10px; height:10px; border-radius:50%;
    background: rgba(184,134,11,0.2); border:2px solid rgba(184,134,11,0.3);
    transition:all 0.3s ease;
  }
  .step.active .step-dot { background:var(--gold-rich); border-color:var(--gold-rich); box-shadow:0 0 0 4px rgba(184,134,11,0.15); }
  .step span { font-size:0.7rem; color:var(--text-muted); font-weight:500; text-transform:uppercase; letter-spacing:0.08em; }
  .step.active span { color:var(--gold-rich); }
  .step-line { flex:1; height:1px; width:60px; background:linear-gradient(90deg, rgba(184,134,11,0.3), rgba(184,134,11,0.1)); margin:0 0.75rem 1.25rem; }

  /* Form Section */
  .form-section { padding:1.75rem 2.5rem 2.5rem; }

  .field { margin-bottom:1.25rem; animation:fadeInUp 0.5s ease-out backwards; }
  .field:nth-child(1){ animation-delay:0.1s; }
  .field:nth-child(2){ animation-delay:0.2s; }
  .field:nth-child(3){ animation-delay:0.3s; }
  .terms-row{ animation:fadeInUp 0.5s ease-out 0.4s backwards; }
  .actions{ animation:fadeInUp 0.5s ease-out 0.5s backwards; }
  @keyframes fadeInUp { from{ opacity:0; transform:translateY(16px); } to{ opacity:1; transform:translateY(0); } }

  .form-label {
    display:block; font-size:0.78rem; font-weight:600; color:var(--text-mid);
    margin-bottom:0.4rem; text-transform:uppercase; letter-spacing:0.08em;
  }

  /* Section divider */
  .section-divider {
    display:flex; align-items:center; gap:0.75rem;
    margin:0.5rem 0 1.25rem;
  }
  .section-divider span { flex:1; height:1px; background:linear-gradient(90deg, transparent, rgba(184,134,11,0.25), transparent); }
  .section-divider p { font-size:0.72rem; color:var(--text-light); font-weight:600; text-transform:uppercase; letter-spacing:0.1em; white-space:nowrap; }

  /* Inputs */
  .input-wrapper { position:relative; }

  .form-input {
    width:100%; padding:0.875rem 2.75rem 0.875rem 3rem;
    font-size:0.92rem; color:var(--text-dark);
    background:rgba(255,255,255,0.85);
    border:1.5px solid rgba(184,134,11,0.2); border-radius:10px;
    outline:none; transition:all 0.3s ease;
    font-family:'DM Sans', sans-serif; backdrop-filter:blur(4px);
  }
  .form-input::placeholder { color:var(--text-light); }
  .form-input:focus {
    background:#FFFFFF; border-color:var(--gold-rich);
    box-shadow: 0 0 0 4px rgba(184,134,11,0.1), 0 4px 16px rgba(184,134,11,0.12), inset 0 1px 3px rgba(0,0,0,0.04);
    transform:translateY(-1px);
  }

  .input-icon {
    position:absolute; left:0.9rem; top:50%; transform:translateY(-50%);
    color:var(--gold-rich); pointer-events:none; opacity:0.7; transition:opacity 0.3s ease;
  }
  .input-icon svg { width:17px; height:17px; }
  .form-input:focus ~ .input-icon { opacity:1; }

  .input-border {
    position:absolute; bottom:0; left:10%; right:10%; height:2px;
    background:linear-gradient(90deg, var(--gold-deep), var(--gold-bright), var(--gold-deep));
    border-radius:0 0 4px 4px; transform:scaleX(0); transition:transform 0.3s ease;
    pointer-events:none;
  }
  .form-input:focus ~ .input-border { transform:scaleX(1); }

  /* Valid checkmark */
  .input-valid-icon {
    position:absolute; right:0.9rem; top:50%; transform:translateY(-50%);
    color:var(--strength-strong); opacity:0; transition:opacity 0.3s ease;
    pointer-events:none;
  }
  .input-valid-icon svg { width:16px; height:16px; }
  .form-input.valid ~ .input-valid-icon { opacity:1; }
  .form-input.valid { border-color:rgba(76,175,110,0.4); }

  /* Toggle password */
  .toggle-password {
    position:absolute; right:0.75rem; top:50%; transform:translateY(-50%);
    background:none; border:none; color:var(--text-light); cursor:pointer;
    padding:0.4rem; display:flex; align-items:center; border-radius:6px; transition:all 0.2s ease;
  }
  .toggle-password:hover { color:var(--gold-rich); background:rgba(184,134,11,0.08); }
  .toggle-password svg { width:17px; height:17px; }

  /* Match indicator */
  .match-indicator {
    position:absolute; right:2.8rem; top:50%; transform:translateY(-50%);
    font-size:0.75rem; font-weight:600; letter-spacing:0.02em;
    opacity:0; transition:opacity 0.3s ease;
  }
  .match-indicator.match { color:var(--strength-strong); opacity:1; }
  .match-indicator.no-match { color:var(--strength-weak); opacity:1; }

  /* Strength meter */
  .strength-meter {
    display:flex; align-items:center; gap:0.5rem;
    margin-top:0.5rem; padding:0 0.25rem;
  }
  .strength-bars { display:flex; gap:4px; flex:1; }
  .bar {
    flex:1; height:4px; border-radius:2px;
    background:rgba(184,134,11,0.12); transition:background 0.4s ease;
  }
  .bar.active-weak   { background:var(--strength-weak); }
  .bar.active-fair   { background:var(--strength-fair); }
  .bar.active-good   { background:var(--strength-good); }
  .bar.active-strong { background:var(--strength-strong); }
  .strength-label { font-size:0.72rem; color:var(--text-light); font-weight:500; min-width:50px; text-align:right; transition:color 0.3s ease; }

  /* Field hint */
  .field-hint {
    display:flex; align-items:center; gap:0.35rem;
    font-size:0.76rem; color:var(--text-light); margin-top:0.4rem; padding:0 0.25rem;
  }
  .field-hint svg { width:13px; height:13px; flex-shrink:0; color:var(--gold-rich); opacity:0.7; }

  /* Terms */
  .terms-row {
    display:flex; align-items:flex-start; gap:0.6rem;
    margin-bottom:1.5rem; padding:0.75rem; border-radius:8px;
    background:rgba(184,134,11,0.04); border:1px solid rgba(184,134,11,0.1);
  }
  .custom-checkbox {
    width:16px; height:16px; cursor:pointer;
    accent-color:var(--gold-rich); flex-shrink:0; margin-top:2px;
  }
  .checkbox-label { font-size:0.815rem; color:var(--text-muted); cursor:pointer; line-height:1.5; }
  .terms-link { color:var(--gold-deep); text-decoration:none; font-weight:600; transition:color 0.2s ease; }
  .terms-link:hover { color:var(--gold-rich); }

  /* Submit */
  .actions { margin:0; }
  .submit-button {
    width:100%; padding:1rem 1.5rem;
    font-size:0.85rem; font-weight:600; letter-spacing:0.04em; text-transform:uppercase;
    color:#FFF8E0;
    background:linear-gradient(135deg, var(--brown-deep) 0%, var(--gold-deep) 30%, var(--gold-rich) 70%, var(--brown-mid) 100%);
    border:none; border-radius:10px; cursor:pointer; position:relative; overflow:hidden;
    box-shadow: 0 8px 24px var(--shadow-gold), 0 2px 8px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,240,160,0.3);
    transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
    font-family:'DM Sans', sans-serif;
  }
  .submit-button::before {
    content:''; position:absolute; top:0; left:-100%; width:100%; height:100%;
    background:linear-gradient(90deg, transparent, rgba(255,240,160,0.25), transparent);
    transition:left 0.5s ease;
  }
  .submit-button::after {
    content:''; position:absolute; inset:1px;
    border-radius:9px; border:1px solid rgba(255,240,160,0.15); pointer-events:none;
  }
  .submit-button:hover {
    transform:translateY(-2px);
    box-shadow: 0 14px 32px var(--shadow-gold), 0 4px 12px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,240,160,0.4);
    background:linear-gradient(135deg, var(--brown-mid) 0%, var(--gold-rich) 30%, var(--gold-bright) 70%, var(--gold-rich) 100%);
  }
  .submit-button:hover::before { left:100%; }
  .submit-button:active { transform:translateY(0); }

  /* Footer */
  .card-footer {
    text-align:center; padding:1.25rem 2.5rem 1.75rem;
    border-top:1px solid rgba(184,134,11,0.1);
    font-size:0.875rem; color:var(--text-muted); position:relative;
  }
  .card-footer::before, .card-footer::after {
    content:''; position:absolute; width:32px; height:32px;
    border-color:rgba(184,134,11,0.2); border-style:solid;
  }
  .card-footer::before { bottom:10px; left:14px; border-width:0 0 2px 2px; border-radius:0 0 0 4px; }
  .card-footer::after  { bottom:10px; right:14px; border-width:0 2px 2px 0; border-radius:0 0 4px 0; }
  .card-footer a { color:var(--gold-deep); text-decoration:none; font-weight:600; transition:color 0.2s ease; margin:0 0.4rem; }
  .card-footer a:hover { color:var(--gold-rich); }

  /* Security note */
  .security-note {
    margin-top:1.75rem; display:flex; align-items:center; justify-content:center;
    gap:0.5rem; font-size:0.77rem; color:rgba(184,134,11,0.55);
    font-weight:500; letter-spacing:0.04em; text-transform:uppercase;
  }
  .security-note svg { width:14px; height:14px; }

  /* Errors */
  #error_explanation {
    margin:0 0 1rem; padding:1rem 1.25rem;
    background:rgba(224,92,92,0.08); border:1px solid rgba(224,92,92,0.25);
    border-radius:10px; border-left:3px solid #E05C5C;
  }
  #error_explanation h2 { font-size:0.85rem; color:#C0392B; font-weight:600; margin-bottom:0.5rem; }
  #error_explanation ul { list-style:none; padding:0; }
  #error_explanation ul li { font-size:0.82rem; color:#9B2335; padding:0.15rem 0; }
  #error_explanation ul li::before { content:'→ '; opacity:0.6; }

  /* Responsive */
  @media (max-width:520px) {
    .signup-wrapper { padding:1rem; }
    .card-header { padding:2.25rem 1.5rem 1.5rem; }
    .card-header h2 { font-size:1.65rem; }
    .form-section { padding:1.5rem; }
    .card-footer { padding:1.25rem 1.5rem 1.5rem; }
    .icon-badge { width:64px; height:64px; }
    .icon-badge svg { width:26px; height:26px; }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {

    // Password toggles
    document.querySelectorAll('.toggle-password').forEach(btn => {
      btn.addEventListener('click', function() {
        const targetId = this.dataset.target;
        const field = document.getElementById(targetId);
        if (!field) return;
        const isPass = field.type === 'password';
        field.type = isPass ? 'text' : 'password';
        const eyeOpen   = this.querySelector('.eye-open');
        const eyeClosed = this.querySelector('.eye-closed');
        if (eyeOpen && eyeClosed) {
          eyeOpen.style.display   = isPass ? 'none'  : 'block';
          eyeClosed.style.display = isPass ? 'block' : 'none';
        }
      });
    });

    // Email validation
    const emailInput = document.querySelector('input[type="email"].form-input');
    if (emailInput) {
      emailInput.addEventListener('blur', function() {
        const valid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value);
        this.classList.toggle('valid', valid && this.value !== '');
      });
    }

    // Password strength
    const pwField = document.getElementById('password-field');
    const bars = document.querySelectorAll('.strength-meter .bar');
    const label = document.getElementById('strength-label');
    const levels = [
      { label:'Faible',   class:'active-weak',   color:'#E05C5C' },
      { label:'Correct',  class:'active-fair',   color:'#E0A040' },
      { label:'Bon',      class:'active-good',   color:'#D4A017' },
      { label:'Fort',     class:'active-strong', color:'#4CAF6E' },
    ];

    function calcStrength(pw) {
      let score = 0;
      if (pw.length >= 8)  score++;
      if (pw.length >= 12) score++;
      if (/[A-Z]/.test(pw) && /[a-z]/.test(pw)) score++;
      if (/[0-9]/.test(pw)) score++;
      if (/[^A-Za-z0-9]/.test(pw)) score++;
      return Math.min(Math.ceil(score / 1.25), 4);
    }

    if (pwField && bars.length) {
      pwField.addEventListener('input', function() {
        const pw = this.value;
        if (!pw) {
          bars.forEach(b => { b.className = 'bar'; });
          label.textContent = '—';
          label.style.color = '';
          return;
        }
        const strength = calcStrength(pw);
        bars.forEach((b, i) => {
          b.className = 'bar';
          if (i < strength) b.classList.add(levels[strength - 1].class);
        });
        label.textContent = levels[strength - 1].label;
        label.style.color = levels[strength - 1].color;
      });
    }

    // Password match
    const confirmField = document.getElementById('password-confirm-field');
    const matchIndicator = document.getElementById('match-indicator');
    if (confirmField && pwField && matchIndicator) {
      function checkMatch() {
        const val = confirmField.value;
        if (!val) { matchIndicator.textContent = ''; matchIndicator.className = 'match-indicator'; return; }
        const matches = val === pwField.value;
        matchIndicator.textContent = matches ? '✓' : '✗';
        matchIndicator.className = 'match-indicator ' + (matches ? 'match' : 'no-match');
      }
      confirmField.addEventListener('input', checkMatch);
      pwField.addEventListener('input', checkMatch);
    }

    // Submit state
    const form = document.querySelector('.signup-form');
    if (form) {
      form.addEventListener('submit', function() {
        const btn = form.querySelector('.submit-button');
        if (btn) {
          btn.style.opacity = '0.75';
          btn.disabled = true;
          btn.textContent = 'Création en cours…';
        }
      });
    }

    // Step indicator — activate second step on password focus
    const step2 = document.querySelector('.steps-indicator .step:last-child');
    if (pwField && step2) {
      pwField.addEventListener('focus', () => step2.classList.add('active'));
    }
  });
</script>
